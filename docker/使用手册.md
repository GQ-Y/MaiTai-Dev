# MineAdmin Docker 镜像导出与导入使用手册

本文档说明如何导出和导入 MineAdmin 的完整 Docker 环境，以便在新的宿主机上快速部署和运行。

## 导出镜像（在源机器上执行）

导出操作已经完成，所有镜像都保存在 `docker/servers` 目录中：
- `redis.tar` - Redis 镜像
- `mysql.tar` - MySQL 镜像
- `nginx.tar` - Nginx Web 服务镜像
- `server.tar` - MineAdmin 后端服务镜像

## 导入并运行（在目标机器上执行）

### 1. 环境准备

确保目标机器已安装：
- Docker Engine
- Docker Compose

### 2. 传输文件

将整个项目目录复制到目标机器。

### 3. 导入镜像并启动服务

在项目根目录执行导入脚本：

```bash
./docker/import.sh
```

该脚本会自动完成以下操作：
1. 导入所有 Docker 镜像
2. 创建必要的目录结构
3. 启动所有服务

### 4. 访问服务

服务启动后，可以通过以下地址访问：

- 后端服务: http://localhost:9501
- 前端服务: http://localhost:9510
- MySQL: localhost:3306 (用户: mineadmin, 密码: 123456)
- Redis: localhost:6379 (密码: 123456)

## 手动导入步骤（可选）

如果不想使用自动脚本，也可以手动执行以下步骤：

```bash
# 导入镜像
docker load -i docker/servers/redis.tar
docker load -i docker/servers/mysql.tar
docker load -i docker/servers/nginx.tar
docker load -i docker/servers/server.tar

# 创建目录
mkdir -p runtime/logs storage/uploads plugin

# 启动服务
docker compose -f docker/docker-compose.yml up -d
```

## 常见问题

### 1. 导入时提示镜像已存在

可以先删除现有镜像再导入：
```bash
docker rmi redis:latest mysql:8.0 nginx:alpine mineadmin-server:latest
```

### 2. 服务启动失败

检查 Docker 和 Docker Compose 是否正常工作：
```bash
docker info
docker compose version
```
